<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>You should write a Python package</title>
<meta name="author" content="William E Fondrie, PhD"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.css"/>

<link rel="stylesheet" href="../../css/dark.css" id="theme"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/plugin/highlight/zenburn.css"/>
<link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@500;600;700&family=Roboto:ital@0;1&display=swap" rel="stylesheet">
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide">
<h1>You should write a Python package</h1><h2></h2><h3> William E Fondrie, PhD</h3><p>2021-03-04</p><p>View online: <a href="https://git.io/python-packaging">https://git.io/python-packaging</a></p>
</section>

<section>
<section id="slide-org044cad2">
<h2 id="org044cad2">Outline</h2>
<ul>
<li class="fragment appear">Why you should write a Python package.<br /></li>
<li class="fragment appear">How to write a Python package.<br /></li>
<li class="fragment appear">Ways to make your package better.<br /></li>

</ul>


</section>
</section>
<section>
<section id="slide-org6fc479a">
<h2 id="org6fc479a">Why should you write a Python package?</h2>

</section>
</section>
<section>
<section id="slide-org203e77d">
<h2 id="org203e77d">To learn more about Python</h2>
<p class="fragment (appear)">
Coming from R, I learned Python by translating a simple R package to Python.<br />
</p>
<ul>
<li class="fragment appear">rpx: <a href="https://github.com/lgatto/rpx">https://github.com/lgatto/rpx</a><br />
<img src="./img/rpx.png" alt="rpx.png" /><br /></li>
<li class="fragment appear">ppx: <a href="https://github.com/wfondrie/ppx">https://github.com/wfondrie/ppx</a><br />
<img src="./img/ppx.png" alt="ppx.png" /><br /></li>

</ul>


</section>
</section>
<section>
<section id="slide-org8a69795">
<h2 id="org8a69795">To easily reuse code for multiple projects</h2>
<p class="fragment (appear)">
I keep useful things in my personal wispy package.<br />
<a href="https://github.com/wfondrie/wispy" class="fragment (appear)">https://github.com/wfondrie/wispy</a><br />
</p>

<div class="column" style="float:left; width:60%">
<p class="fragment (appear)">
For a talk:<br />
</p>
<div class="org-src-container">

<pre class="fragment (appear)"><code class="python" >import numpy as np
import matplotlib.pyplot as plt
from wispy import theme

pal = theme.talk(dark=True)

np.random.seed(42)
plt.figure()
plt.plot(np.random.randn(10))
plt.plot(np.random.randn(10) + np.arange(10))
plt.show()
</code></pre>
</div>
</div>

<div class="column" style="float:right; width:40%">

<div id="org17b9b03" class="figure">
<p><img src="./img/theme.png" alt="theme.png" class="fragment (appear)" /><br />
</p>
</div>
</div>

</section>
</section>
<section>
<section id="slide-org495c871">
<h2 id="org495c871">To easily reuse code for multiple projects</h2>
<p>
I keep useful things in my personal wispy package.<br />
<a href="https://github.com/wfondrie/wispy">https://github.com/wfondrie/wispy</a><br />
</p>

<div class="column" style="float:left; width:60%">
<p>
For a paper:<br />
</p>
<div class="org-src-container">

<pre><code class="python" >import numpy as np
import matplotlib.pyplot as plt
from wispy import theme

pal = theme.paper()

np.random.seed(42)
plt.figure()
plt.plot(np.random.randn(10))
plt.plot(np.random.randn(10) + np.arange(10))
plt.show()
</code></pre>
</div>
</div>

<div class="column" style="float:right; width:40%">

<div id="orgc0a727f" class="figure">
<p><img src="./img/theme.png" alt="theme.png" /><br />
</p>
</div>
</div>

</section>
</section>
<section>
<section id="slide-org410178e">
<h2 id="org410178e">To easily reuse code for multiple projects</h2>
<p>
I keep useful things in my personal wispy package.<br />
<a href="https://github.com/wfondrie/wispy">https://github.com/wfondrie/wispy</a><br />
</p>

<div class="column" style="float:left; width:60%">
<p>
For a paper:<br />
</p>
<div class="org-src-container">

<pre><code class="python" >import numpy as np
import matplotlib.pyplot as plt
from wispy import theme

pal = theme.paper()

np.random.seed(42)
plt.figure()
plt.plot(np.random.randn(10))
plt.plot(np.random.randn(10) + np.arange(10))
plt.show()
</code></pre>
</div>
</div>

<div class="column" style="float:right; width:40%">

<div id="orgaa3a078" class="figure">
<p><img src="./img/theme_paper.png" alt="theme_paper.png" /><br />
</p>
</div>
</div>



</section>
</section>
<section>
<section id="slide-org2875d43">
<h2 id="org2875d43">To distribute software, so that folks can use it</h2>
<ul>
<li class="fragment appear">Python packages are easy to install&#x2026; <i>most of the time</i>.<br /></li>
<li class="fragment appear">A recent example for me is mokapot: <a href="https://github.com/wfondrie/mokapot">https://github.com/wfondrie/mokapot</a><br /></li>
<li class="fragment appear"><p>
Install with pip or conda:<br />
</p>
<div class="org-src-container">

<pre><code class="bash" >  # With conda:
  conda install -c bioconda mokapot

  # With pip:
  pip install mokapot
</code></pre>
</div></li>

</ul>


</section>
</section>
<section>
<section id="slide-orgd1dbf9c">
<h2 id="orgd1dbf9c">How do you write a Python package?</h2>

</section>
</section>
<section>
<section id="slide-orgdd25ab2">
<h2 id="orgdd25ab2">Let&rsquo;s make a package together</h2>
<ul>
<li class="fragment appear">We&rsquo;ll make a package called <b><b>inspired</b></b>.<br /></li>
<li class="fragment appear"><p>
It will provide random inspirational messages on demand (for error and progress messages):<br />
</p>
<div class="org-src-container">

<pre class="fragment (appear)"><code class="python" >  import inspired

  try:
      assert 1 == 2
  except AssertionError:
      raise AssertionError(inspired.by_yoda())

  # AssertionError: Do or do not. There is no try.
</code></pre>
</div></li>

</ul>


</section>
</section>
<section>
<section id="slide-orgb630d3e">
<h2 id="orgb630d3e">The structure of our package</h2>
<ul>
<li class="fragment appear"><p>
A package is little more than a collection of python scripts:<br />
</p>
<pre class="example" id="org1bcc5c0">
  inspired
  |- LICENSE
  |- README.md
  |- inspired
  |  |- __init__.py
  |  |- yoda.py
  |  `- (*.py files for other messages)
  |- pyproject.toml
  |- setup.cfg
  `- setup.py
</pre></li>

<li class="fragment appear">Many details at <a href="https://packaging.python.org/tutorials/packaging-projects/">https://packaging.python.org/tutorials/packaging-projects/</a><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org73c83a8">
<h2 id="org73c83a8">The README</h2>
<ul>
<li class="fragment appear">Describes the package to whatever level of detail we want.<br /></li>
<li class="fragment appear"><p>
We&rsquo;ll keep ours simple:<br />
</p>
<pre class="example" id="org1b77243">
  # inspired
  Effortlessly inject inspirational messages into your Python code.
</pre></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgb33e032">
<h2 id="orgb33e032">The LICENSE</h2>
<ul>
<li class="fragment appear">There are a few open-source license to choose from.<br /></li>
<li class="fragment appear">Check out <a href="https://choosealicense.com/">https://choosealicense.com/</a> for help.<br /></li>
<li class="fragment appear">We&rsquo;ll use the MIT license for inspired.<br /></li>

</ul>

<blockquote class="fragment (appear)">
<p>
The MIT License is short and to the point. It lets people do almost anything they want with your project, like making and distributing closed source versions.<br />
</p>
</blockquote>

</section>
</section>
<section>
<section id="slide-orgb18846c">
<h2 id="orgb18846c">pyproject.toml specifies configurations for build tools</h2>
<ul>
<li class="fragment appear">A good blog post on why it is helpful <a href="https://snarky.ca/what-the-heck-is-pyproject-toml/">https://snarky.ca/what-the-heck-is-pyproject-toml/</a><br /></li>
<li class="fragment appear"><p>
For our basic package, our <code>pyproject.toml</code> is:<br />
</p>
<div class="org-src-container">

<pre><code class="toml" >  [build-system]
  requires = [
      "setuptools&gt;=42",
      "wheel"
  ]
  build-backend = "setuptools.build_meta"
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-org58fc4a8">
<h2 id="org58fc4a8">setup.cfg defines your package metadata</h2>
<ul>
<li>See <a href="https://packaging.python.org/tutorials/packaging-projects/">https://packaging.python.org/tutorials/packaging-projects/</a> for the available fields.<br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org2dce27f">
<h2 id="org2dce27f">setup.py is no longer necessary</h2>
<ul>
<li class="fragment appear"><code>setup.py</code> is the legacy way to define what we did in <code>pyproject.toml</code> and <code>setup.cfg</code>.<br /></li>
<li class="fragment appear"><p>
However, it is needed to create editable installs, which are super useful!<br />
</p>
<div class="org-src-container">

<pre><code class="bash" >  pip install -e .
</code></pre>
</div></li>
<li class="fragment appear"><p>
Ours will be:<br />
</p>
<div class="org-src-container">

<pre><code class="python" >  import setuptools

  setuptools.setup()
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-org9cd5a05">
<h2 id="org9cd5a05"><code>__init__.py</code> tells Python that a directory is a package</h2>
<ul>
<li class="fragment appear">Things that are imported into <code>__init__.py</code> are easily available to users.<br /></li>
<li class="fragment appear"><code>__init__.py</code> can be empty.<br /></li>
<li class="fragment appear"><p>
Ours will be:<br />
</p>
<div class="org-src-container">

<pre><code class="python" >  from .yoda import by_yoda
</code></pre>
</div></li>
<li class="fragment appear">Now we need to create a <code>by_yoda()</code> function in <code>yoda.py</code><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org7d4e233">
<h2 id="org7d4e233">The other Python files define the package functionality</h2>
<ul>
<li class="fragment appear">Each is referred to as a module.<br /></li>
<li class="fragment appear">Functions, classes, constants, etc that are imported by <code>__init__.py</code> are<br />
available at the top level of the package.<br /></li>
<li class="fragment appear"><p>
Others can be reached through their respective modules.<br />
</p>
<div class="org-src-container">

<pre><code class="python" >  import os
  os.path.isfile("blah.txt")
</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-org7a9b76a">
<h2 id="org7a9b76a">Let&rsquo;s finish our package and see if it works.</h2>
<p>
<a href="https://github.com/wfondrie/inspired">https://github.com/wfondrie/inspired</a><br />
</p>


</section>
</section>
<section>
<section id="slide-org5cc4b70">
<h2 id="org5cc4b70">How can you make your package better?</h2>

</section>
</section>
<section>
<section id="slide-org68c3a89">
<h2 id="org68c3a89">Documentation makes your package usable</h2>
<ul>
<li class="fragment appear">Create beautiful docs: sphinx <a href="https://www.sphinx-doc.org/en/master/">https://www.sphinx-doc.org/en/master/</a><br /></li>
<li class="fragment appear"><p>
Sphinx can generate documentation automatically from your Python docstrings!<br />
</p>
<div class="org-src-container">

<pre><code class="python" >  def add(x, y):
      """Add x and y.

      Calculate a simple sum between two numbers.

      Parameters
      ----------
      x : float
          The first number to add.
      y : float
          The second number to add.

      Returns
      -------
      float
          The sum of x and y.
      """
      return x + y
</code></pre>
</div></li>

</ul>


</section>
</section>
<section>
<section id="slide-orge25c9b6">
<h2 id="orge25c9b6">Tests verify that your package works</h2>
<ul>
<li class="fragment appear">Create and run tests: pytest<br />
<a href="https://docs.pytest.org/en/stable/">https://docs.pytest.org/en/stable/</a><br /></li>
<li class="fragment appear">Run tests with each commit (continuous integration): GitHub Actions<br />
<a href="https://docs.github.com/en/actions">https://docs.github.com/en/actions</a><br /></li>
<li class="fragment appear">Get reports about how much code your tests cover: Codecov<br />
<a href="https://about.codecov.io/">https://about.codecov.io/</a><br /></li>

</ul>


</section>
</section>
<section>
<section id="slide-org6cbe045">
<h2 id="org6cbe045">Linters standardize code style (and find problems)</h2>
<ul>
<li class="fragment appear">PEP8 describes the Python style standards<br />
<a href="https://www.python.org/dev/peps/pep-0008/">https://www.python.org/dev/peps/pep-0008/</a><br /></li>
<li class="fragment appear">Automatically format code: black<br />
<a href="https://black.readthedocs.io/en/stable/">https://black.readthedocs.io/en/stable/</a><br /></li>
<li class="fragment appear">Bonus: setup black as a pre-commit hook<br />
<a href="https://black.readthedocs.io/en/stable/version_control_integration.html">https://black.readthedocs.io/en/stable/version_control_integration.html</a><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org73222d3">
<h2 id="org73222d3">Publish your package, so folks can use it!</h2>
<ul>
<li class="fragment appear">The Python Package Index (PyPI)<br />
<a href="https://pypi.org/">https://pypi.org/</a><br /></li>
<li class="fragment appear">Bioconda (for bio-related packages)<br />
<a href="https://bioconda.github.io/">https://bioconda.github.io/</a><br /></li>
<li class="fragment appear">Conda-Forge (for everything else)<br />
<a href="https://conda-forge.org/">https://conda-forge.org/</a><br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-org6721f37">
<h2 id="org6721f37">Questions?</h2>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js/plugin/highlight/highlight.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,

overview: true,
width: 1920,
height: 1080,

transition: 'none',
transitionSpeed: 'default',

// Plugins with reveal.js 4.x
plugins: [ RevealHighlight ],

// Optional libraries used to extend reveal.js
dependencies: [
]

});
</script>
</body>
</html>
